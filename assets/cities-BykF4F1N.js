import{g as E}from"./unsplash-BYHeF-WM.js";const x={"new delhi":{name:"New Delhi",identity:"The cultural and political heart of India",image:"https://images.unsplash.com/photo-1587595431973-160d0d94add1?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80",quickFacts:{region:"North India",bestTime:"Oct – Mar",knownFor:"History & Food",duration:"2–3 Days",vibe:"Historic & Modern"},places:[{name:"India Gate",image:"https://images.unsplash.com/photo-1506368249639-73a05d6f6488?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60",descriptor:"War Memorial"},{name:"Qutub Minar",image:"https://images.unsplash.com/photo-1551932732-6ce805c262e8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60",descriptor:"UNESCO Heritage"},{name:"Red Fort",image:"https://images.unsplash.com/photo-1609947017136-9daf32a5eb16?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60",descriptor:"Mughal Architecture"},{name:"Humayun's Tomb",image:"https://images.unsplash.com/photo-1587595431973-160d0d94add1?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60",descriptor:"Garden Tomb"},{name:"Lotus Temple",image:"https://images.unsplash.com/photo-1519074069444-1ba4fff66d16?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60",descriptor:"Bahá'í House of Worship"},{name:"Chandni Chowk",image:"https://images.unsplash.com/photo-1524338198850-8a2ff63aaceb?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60",descriptor:"Old Delhi Market"}],interests:[{name:"Culture & History",image:"https://images.unsplash.com/photo-1566552881560-0be862a7c445?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"},{name:"Food & Markets",image:"https://images.unsplash.com/photo-1506368249639-73a05d6f6488?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"},{name:"Nature & Outdoors",image:"https://images.unsplash.com/photo-1590050752117-9c6031142816?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"},{name:"Modern City",image:"https://images.unsplash.com/photo-1565509969663-38d7527a6da6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"}],tips:["Use the Delhi Metro to explore efficiently; it's clean, safe, and connects most major spots.","Dress modestly when visiting religious sites (cover shoulders and knees).","Street food is delicious but stick to busy stalls; bottled water is recommended."]}},b="https://wft-geo-db.p.rapidapi.com/v1/geo",w="b7e15cbae2msh543edde3e9f5ff0p1010f9jsn2f594a61b3f7",y="wft-geo-db.p.rapidapi.com",T=async(e,a,c=10)=>{if(!e)return[];const s=`cities_v2_${a}_${c}`,u=1440*60*1e3,l=localStorage.getItem(s);if(l){const{timestamp:n,data:t}=JSON.parse(l);if(Date.now()-n<u)return console.log(`Using cached cities for ${e}`),t}if(console.log(`Fetching cities for ${e} (${a}) with limit ${c}`),a)try{const n={method:"GET",headers:{"x-rapidapi-key":w,"x-rapidapi-host":y}},t=await fetch(`${b}/cities?countryIds=${a}&types=CITY&sort=-population&limit=${c}&minPopulation=50000`,n);if(t.ok){const r=await t.json();if(console.log("GeoDB Response:",r),r.data&&r.data.length>0){const p=r.data.map(async(o,f)=>{let i=await E(`${o.name} city landmark`);i||(i=`https://loremflickr.com/800/600/${o.name.replace(/\s+/g,",")},city?lock=${f}`);const h=o.name.toLowerCase();let d=null;const $={mumbai:"The city of dreams, known for its vibrant nightlife, Bollywood, and colonial architecture.",bengaluru:"The Silicon Valley of India, famous for its parks, nightlife, and pleasant climate.",hyderabad:"A city of pearls and biryani, blending rich history with a booming tech industry.",chennai:"The cultural capital of South India, known for its temples, beaches, and classical arts.",kolkata:"The artistic and intellectual capital, famous for its literature, sweets, and colonial heritage.",jaipur:"The Pink City, known for its stunning palaces, forts, and vibrant bazaars.",udaipur:"The City of Lakes, famous for its romantic setting and lavish royal residences.",agra:"Home to the Taj Mahal, a symbol of eternal love and Mughal architectural brilliance.",varanasi:"The spiritual capital of India, one of the world's oldest living cities on the banks of the Ganges.",kochi:"Queen of the Arabian Sea, known for its Chinese fishing nets and colonial history.",pune:"The Oxford of the East, a vibrant hub of education, culture, and history."};$[h]?d=$[h]:x[h]?.identity&&(d=x[h].identity);const k=[`Discover the unique charm and vibrant streets of ${o.name}.`,`A bustling hub in ${o.country}, offering a mix of history and modernity.`,`Explore ${o.name}, known for its local culture and welcoming atmosphere.`,`Experience the authentic lifestyle and landmarks of ${o.name}.`],C=k[f%k.length];return{name:o.name,image:i,description:d||C,lat:o.latitude,lon:o.longitude}}),m=await Promise.all(p);return console.log(`Successfully fetched ${m.length} cities.`),localStorage.setItem(s,JSON.stringify({timestamp:Date.now(),data:m})),m}else console.warn("GeoDB returned no cities.")}else console.error(`GeoDB Error: ${t.status} ${t.statusText}`),t.status===429&&console.warn("Rate limit exceeded. Try again later.")}catch(n){console.warn("GeoDB API failed:",n)}return[]},I=async e=>{try{const a={method:"GET",headers:{"x-rapidapi-key":w,"x-rapidapi-host":y}},s=await(await fetch(`${b}/cities?namePrefix=${encodeURIComponent(e)}&limit=1&sort=-population`,a)).json();return s.data&&s.data.length>0?s.data[0].id:null}catch(a){return console.warn("Failed to fetch city ID:",a),null}},g=new Map,q=async(e,a=5)=>{if(!e)return[];const c=`nearby_${e}_${a}`,s=1440*60*1e3,u=localStorage.getItem(c);if(u){const{timestamp:t,data:r}=JSON.parse(u);if(Date.now()-t<s)return console.log(`Using cached nearby cities for ${e}`),r}const l=`req_${e}_${a}`;if(g.has(l))return console.log(`Using in-flight API request for ${e}`),g.get(l);const n=(async()=>{try{const t=await I(e);if(!t)throw new Error("City ID not found");const r={method:"GET",headers:{"x-rapidapi-key":w,"x-rapidapi-host":y}},p=await fetch(`${b}/cities/${t}/nearbyCities?radius=300&limit=${a}&minPopulation=50000&sort=-population`,r);if(p.status===429)return console.warn("GeoDB Rate Limit Exceeded (429)"),[];if(!p.ok)throw new Error("GeoDB Nearby API failed");const m=await p.json();if(m.data){const o=m.data.map(async(i,h)=>{let d=await E(`${i.name} city landmark`);return d||(d=`https://loremflickr.com/800/600/${i.name.replace(/\s+/g,",")},city?lock=${h}`),{name:i.name,image:d,distance:i.distance?`${Math.round(i.distance*1.609)} km`:"Nearby",description:`Explore ${i.name}, a vibrant destination nearby.`}}),f=await Promise.all(o);return localStorage.setItem(c,JSON.stringify({timestamp:Date.now(),data:f})),f}}catch(t){return console.warn("Error fetching nearby cities:",t),[]}})();return g.set(l,n),n.finally(()=>{g.delete(l)})};export{q as a,T as f};
